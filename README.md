# PDDL-Grounder
A tool that, given as input the domain.pddl and problem.pddl files, generates the grounded translation of the problem

## Requirements
* Python version: 3.7 or higher
* [Antlr4](https://www.antlr.org/) 
* [Antlr4 Python3 runtime target](https://www.antlr.org/download.html)
* [Click Python Library](https://click.palletsprojects.com/en/8.1.x/): Package for creating command line interfaces

## Code Overview
* [pddl.g4](pddl.g4) - The grammar file. It currently supports a simplified version of PDDL+.<br/><br/> **For example** [domain.pddl](PDDL_Files/domain.pddl) [problem-1.pddl](PDDL_Files/problem-1.pddl).

* [antlr4_directory](antlr4_directory) - The folder generated by antlr4 using the pddl.g4 grammar with the command: 
  ```bash
  antlr4 -Dlanguage=python3 pddl.g4 -o antlr4_directory
  ```
* [grounder.py](grounder.py) - The main module


### myUtilities Folder
* [Domain_parser.py](/myUtilities/Domain_parser.py) - It contains the functions needed to traverse the parse-tree of the domain generated by the antlr4 parser and to represent the tree in JSON format. <br /><br />**For example** [domain.json](json_results/domain.json).

* [Problem_parser.py](/myUtilities/Problem_parser.py) - It contains the functions needed to traverse the parse-tree of the problem generated by the antlr4 parser and to represent the tree in JSON format. <br /><br />**For example** [problem.json](json_results/problem.json).

* [Grounding.py](/myUtilities/Grounding.py) - Contains functions for grounding actions, processes, and events of a domain represented in JSON, given a problem represented in JSON. The result is a JSON file. <br /><br />
**For example** Inputs: [domain.json](json_results/domain.json), [problem.json](json_results/problem.json)  Output: [result.json](json_results/grounding_result.json)

* [Writer.py](/myUtilities/Writer.py) - Contains the function to write the grounded translation of the domain.pddl file <br /><br />**For example** [domain_grounded.pddl](results/domain_grounded.pddl).

## How to use
To run the script simply run the command above, where `--domain` takes the name of the PDDL domain file and `--problem` takes the name of the PDDL problem file. These files MUST be present in the PDDL_Files folder.

```bash
python grounder.py --domain domain.pddl --problem problem-1.pddl
```

If some changes to the grammar file pddl.g4 are needed, the new parser and lexer are generated with the command:
```bash
antlr4 -Dlanguage=python3 pddl.g4 -o antlr4_directory
```

## Resources
* A [grammar](https://gitlab.com/enricos83/PPMAJAL-Expressive-PDDL-Java-Library/-/blob/master/grammar/Pddl.g) that supports more complex domains in **PDDL 3** BUT in **antlr3**
* [PDDL documentation] (https://planning.wiki/)
* A simple [PDDL+ domain and some problems](https://anonymous.4open.science/r/deltaExperiments-F380/CoOpRovers/no-delta)
* Online [Syntactic Tree Viewer](https://christos-c.com/treeviewer/): Very useful during the development phase to graphically visualize the tree generated by the antlr4 parser
